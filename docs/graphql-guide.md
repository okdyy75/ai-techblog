# GraphQLå®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼šã‚¼ãƒ­ã‹ã‚‰å®Ÿè·µã¾ã§

Web APIé–‹ç™ºã®ä¸–ç•Œã§ã¯ã€é•·ã‚‰ãRESTãŒä¸»æµã§ã—ãŸã€‚ã—ã‹ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¤‡é›‘åŒ–ã™ã‚‹ä¸­ã§ã€ãã®èª²é¡Œã‚’è§£æ±ºã™ã‚‹æŠ€è¡“ã¨ã—ã¦ã€ŒGraphQLã€ãŒç™»å ´ã—ã¾ã—ãŸã€‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€GraphQLã®åŸºæœ¬çš„ãªæ¦‚å¿µã‹ã‚‰ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ»ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®å®Ÿè·µçš„ãªå®Ÿè£…ã€ãã—ã¦é«˜åº¦ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¾ã§ã‚’ç¶²ç¾…çš„ã«è§£èª¬ã—ã¾ã™ã€‚ã“ã®1ã¤ã®è¨˜äº‹ã‚’èª­ã¿çµ‚ãˆã‚‹é ƒã«ã¯ã€GraphQLã‚’ä½¿ã£ãŸãƒ¢ãƒ€ãƒ³ãªAPIé–‹ç™ºã®å…¨ä½“åƒã‚’æ´ã‚€ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚

---

## ç¬¬1éƒ¨: GraphQLã®åŸºæœ¬ã‚’ç†è§£ã™ã‚‹

ã¾ãšã¯ã€GraphQLãŒã©ã®ã‚ˆã†ãªæŠ€è¡“ã§ã€ãªãœæ³¨ç›®ã•ã‚Œã¦ã„ã‚‹ã®ã‹ã€ãã®ä¸­å¿ƒçš„ãªæ¦‚å¿µã‹ã‚‰å­¦ã‚“ã§ã„ãã¾ã—ã‚‡ã†ã€‚

### 1.1. GraphQLã¨ã¯ï¼Ÿ

GraphQLã¯ã€Facebookï¼ˆç¾Metaï¼‰ç¤¾ãŒ2012å¹´ã«ç¤¾å†…ã§é–‹ç™ºã‚’å§‹ã‚ã€2015å¹´ã«ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã¨ã—ã¦å…¬é–‹ã—ãŸ**APIã®ãŸã‚ã®ã‚¯ã‚¨ãƒªè¨€èª**ã§ã‚ã‚Šã€ãã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã™ã€‚

æœ€å¤§ã®ç‰¹å¾´ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’ã‚¯ã‚¨ãƒªã¨ã—ã¦å®šç¾©ã—ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãã®é€šã‚Šã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚Œã‚‹ç‚¹ã«ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€APIã®æŸ”è»Ÿæ€§ã¨åŠ¹ç‡ãŒåŠ‡çš„ã«å‘ä¸Šã—ã¾ã™ã€‚

### 1.2. REST APIãŒæŠ±ãˆã‚‹èª²é¡Œ

GraphQLã®åˆ©ç‚¹ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã€ã¾ãšã¯å¾“æ¥ã®REST APIãŒæŠ±ãˆã‚‹ä»£è¡¨çš„ãªèª²é¡Œã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

- **ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚§ãƒƒãƒãƒ³ã‚° (Over-fetching)**: APIã‹ã‚‰å¿…è¦ä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã—ã¾ã†å•é¡Œã§ã™ã€‚ä¾‹ãˆã°ã€è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ä¸€è¦§ã ã‘ãŒæ¬²ã—ã„ã®ã«ã€æœ¬æ–‡ã‚„è‘—è€…æƒ…å ±ã¾ã§å«ã¾ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å©ã„ã¦ã—ã¾ã†ã‚±ãƒ¼ã‚¹ãŒã“ã‚Œã«ã‚ãŸã‚Šã¾ã™ã€‚
- **ã‚¢ãƒ³ãƒ€ãƒ¼ãƒ•ã‚§ãƒƒãƒãƒ³ã‚° (Under-fetching)**: é€†ã«1ã¤ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã¯ãƒ‡ãƒ¼ã‚¿ãŒè¶³ã‚Šãšã€è¤‡æ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„å•é¡Œã§ã™ã€‚ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã¨ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŠ•ç¨¿ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€`/users/:id`ã¨`/users/:id/posts`ã®2ã¤ã®APIã‚’å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚‹ã‚±ãƒ¼ã‚¹ã§ã™ã€‚

### 1.3. GraphQLã®ä¸»ãªç‰¹å¾´ã¨ãƒ¡ãƒªãƒƒãƒˆ

- **å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’å–å¾—**: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚¯ã‚¨ãƒªã§æŒ‡å®šã—ãŸãƒ‡ãƒ¼ã‚¿ã ã‘ãŒè¿”ã•ã‚Œã‚‹ãŸã‚ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ãŒèµ·ã“ã‚Šã¾ã›ã‚“ã€‚
- **ä¸€åº¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å®Œçµ**: é–¢é€£ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åº¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¾ã¨ã‚ã¦å–å¾—ã§ãã‚‹ãŸã‚ã€ã‚¢ãƒ³ãƒ€ãƒ¼ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ãŒè§£æ¶ˆã•ã‚Œã¾ã™ã€‚
- **å¼·åŠ›ãªå‹ã‚·ã‚¹ãƒ†ãƒ **: ã‚¹ã‚­ãƒ¼ãƒã«ã‚ˆã£ã¦APIã®ä»•æ§˜ãŒå³å¯†ã«å®šç¾©ã•ã‚Œã€é–‹ç™ºè€…ã¯APIã®æ§‹é€ ã‚’å®¹æ˜“ã«æŠŠæ¡ã§ãã¾ã™ã€‚
- **é€²åŒ–ã™ã‚‹API**: ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒä¸€ã¤ï¼ˆé€šå¸¸ã¯ `/graphql`ï¼‰ã§ã‚ã‚‹ãŸã‚ã€APIã®å¤‰æ›´ãŒå®¹æ˜“ã§ã™ã€‚

### 1.4. GraphQLã®åŸºæœ¬çš„ãªæ§‹æˆè¦ç´ 

GraphQLã¯ä¸»ã«3ã¤ã®è¦ç´ ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

- **ã‚¯ã‚¨ãƒª (Query)**: ãƒ‡ãƒ¼ã‚¿ã®**èª­ã¿å–ã‚Š**ã‚’è¡Œã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚
  ```graphql
  query { post(id: "1") { title, author { name } } }
  ```
- **ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ (Mutation)**: ãƒ‡ãƒ¼ã‚¿ã®**æ›¸ãè¾¼ã¿**ï¼ˆä½œæˆã€æ›´æ–°ã€å‰Šé™¤ï¼‰ã‚’è¡Œã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚
  ```graphql
  mutation { createPost(title: "æ–°ã—ã„è¨˜äº‹") { id, title } }
  ```
- **ã‚¹ã‚­ãƒ¼ãƒ (Schema)**: APIã§é€å—ä¿¡ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã‚’å®šç¾©ã—ãŸã€Œè¨­è¨ˆå›³ã€ã§ã™ã€‚SDL (Schema Definition Language) ã‚’ä½¿ã£ã¦è¨˜è¿°ã—ã¾ã™ã€‚
  ```graphql
  type Post { id: ID!, title: String! }
  type Query { post(id: ID!): Post }
  ```

---

## ç¬¬2éƒ¨: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ§‹ç¯‰ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å®Ÿè·µï¼‰

æ¦‚å¿µã‚’ç†è§£ã—ãŸã¨ã“ã‚ã§ã€æ¬¡ã¯å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã—ã¦GraphQLã‚µãƒ¼ãƒãƒ¼ã‚’æ§‹ç¯‰ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã“ã§ã¯Node.jsã¨ã€ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã§ã‚ã‚‹Apollo Serverã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

### 2.1. é–‹ç™ºç’°å¢ƒã®æº–å‚™ (Node.js)

1.  **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–**:
    ```bash
    mkdir graphql-server-example && cd graphql-server-example
    npm init -y
    ```
2.  **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**:
    ```bash
    npm install @apollo/server graphql
    ```

### 2.2. Apollo Serverã§ã‚µãƒ¼ãƒãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹

ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ã¯3ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¡Œã„ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«`index.js`ã‚’ä½œæˆã—ã¦é€²ã‚ã¾ã—ã‚‡ã†ã€‚

1.  **ã‚¹ã‚­ãƒ¼ãƒ (Schema) ã®å®šç¾©**: APIã®è¨­è¨ˆå›³ã‚’ã‚³ãƒ¼ãƒ‰ã«è½ã¨ã—è¾¼ã¿ã¾ã™ã€‚
2.  **ãƒªã‚¾ãƒ«ãƒ (Resolver) ã®ä½œæˆ**: ã‚¹ã‚­ãƒ¼ãƒã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾å¿œã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’è¨˜è¿°ã—ã¾ã™ã€‚
3.  **ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•**: ã‚¹ã‚­ãƒ¼ãƒã¨ãƒªã‚¾ãƒ«ãƒã‚’Apollo Serverã«æ¸¡ã—ã¦èµ·å‹•ã—ã¾ã™ã€‚

```javascript
// index.js
import { ApolloServer } from '@apollo/server';
import { startStandaloneServer } from '@apollo/server/standalone';

// ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿
const posts = [{ id: '1', title: 'GraphQLå…¥é–€', authorId: '101' }];
const users = [{ id: '101', name: 'Alice' }];

// 1. ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
const typeDefs = `#graphql
  type Post { id: ID!, title: String, author: User }
  type User { id: ID!, name: String }
  type Query { allPosts: [Post], post(id: ID!): Post }
`;

// 2. ãƒªã‚¾ãƒ«ãƒå®šç¾©
const resolvers = {
  Query: {
    allPosts: () => posts,
    post: (parent, args) => posts.find(post => post.id === args.id),
  },
  // Postå‹ã®authorãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒè¦æ±‚ã•ã‚ŒãŸã¨ãã®å‡¦ç†
  Post: {
    author: (parent) => users.find(user => user.id === parent.authorId),
  },
};

// 3. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
const server = new ApolloServer({ typeDefs, resolvers });
const { url } = await startStandaloneServer(server, { listen: { port: 4000 } });
console.log(`ğŸš€ Server ready at: ${url}`);
```
`package.json`ã«`"type": "module"`ã‚’è¿½åŠ ã—ã€`npm start` (node index.js) ã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ã€‚`http://localhost:4000`ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€Apollo SandboxãŒé–‹ãã€ã‚¯ã‚¨ãƒªã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

### 2.3. ã‚¹ã‚­ãƒ¼ãƒã¨ãƒªã‚¾ãƒ«ãƒã®æ·±æ˜ã‚Š

GraphQLé–‹ç™ºã¯ã€ã¾ãšã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã™ã‚‹ã€Œ**ã‚¹ã‚­ãƒ¼ãƒé§†å‹•é–‹ç™º**ã€ãŒåŸºæœ¬ã§ã™ã€‚ã‚¹ã‚­ãƒ¼ãƒã§APIã®å‹ã‚„æ§‹é€ ã‚’å³å¯†ã«å®šç¾©ã—ã¾ã™ã€‚

- **ã‚¹ã‚«ãƒ©ãƒ¼å‹**: `Int`, `Float`, `String`, `Boolean`, `ID`
- **ä¿®é£¾å­**:
    - `!`: Non-Null (å¿…é ˆ) ã‚’ç¤ºã™ã€‚ä¾‹: `String!`
    - `[]`: List (é…åˆ—) ã‚’ç¤ºã™ã€‚ä¾‹: `[Post]`

ãƒªã‚¾ãƒ«ãƒã¯ã€ã‚¹ã‚­ãƒ¼ãƒã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’çµã³ã¤ã‘ã‚‹é–¢æ•°ã§ã™ã€‚`parent`å¼•æ•°ã‚’å—ã‘å–ã‚‹ã“ã¨ã§ã€`Post`ãƒªã‚¾ãƒ«ãƒãŒãã®è¦ªã§ã‚ã‚‹`Query`ãƒªã‚¾ãƒ«ãƒã®çµæœï¼ˆå€‹ã€…ã®Postã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã€ãƒªã‚¾ãƒ«ãƒãƒã‚§ãƒ¼ãƒ³ã‚’å½¢æˆã—ã¦ã‚°ãƒ©ãƒ•æ§‹é€ ã®ãƒ‡ãƒ¼ã‚¿ã‚’è§£æ±ºã—ã¾ã™ã€‚

---

## ç¬¬3éƒ¨: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é€£æº

ã‚µãƒ¼ãƒãƒ¼ãŒå®Œæˆã—ãŸã‚‰ã€æ¬¡ã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ã“ã“ã§ã¯Reactã¨ã€é«˜æ©Ÿèƒ½ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹Apollo Clientã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### 3.1. é–‹ç™ºç’°å¢ƒã®æº–å‚™ (React)

1.  **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ**: `npx create-react-app my-graphql-app`
2.  **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**: `npm install @apollo/client graphql`

### 3.2. Apollo Clientå…¥é–€

`src/index.js`ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’åˆæœŸåŒ–ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’`ApolloProvider`ã§ãƒ©ãƒƒãƒ—ã—ã¾ã™ã€‚

```javascript
// src/index.js
import { ApolloClient, InMemoryCache, ApolloProvider } from '@apollo/client';

const client = new ApolloClient({
  uri: 'http://localhost:4000/', // ã‚µãƒ¼ãƒãƒ¼ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  cache: new InMemoryCache(),
});

// <ApolloProvider client={client}><App /></ApolloProvider> ã§ãƒ©ãƒƒãƒ—ã™ã‚‹
```

### 3.3. ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã¨è¡¨ç¤º (`useQuery`)

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§`useQuery`ãƒ•ãƒƒã‚¯ã‚’ä½¿ã„ã€å®£è¨€çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚

```javascript
// src/components/Posts.js
import { useQuery, gql } from '@apollo/client';

const GET_ALL_POSTS = gql`
  query GetAllPosts { allPosts { id, title } }
`;

function Posts() {
  const { loading, error, data } = useQuery(GET_ALL_POSTS);

  if (loading) return <p>Loading...</p>;
  if (error) return <p>Error: {error.message}</p>;

  return (
    <ul>
      {data.allPosts.map(({ id, title }) => <li key={id}>{title}</li>)}
    </ul>
  );
}
```
`useQuery`ã¯`loading`, `error`, `data`ã®çŠ¶æ…‹ã‚’è‡ªå‹•ã§ç®¡ç†ã—ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã¦ãã‚Œã¾ã™ã€‚

### 3.4. ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãƒ»æ›´æ–° (`useMutation`)

ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãè¾¼ã¿ã«ã¯`useMutation`ãƒ•ãƒƒã‚¯ã‚’ä½¿ã„ã¾ã™ã€‚

```javascript
// `useRef`ãƒ•ãƒƒã‚¯ã‚’`react`ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã®ã‚’å¿˜ã‚Œãªã„ã‚ˆã†ã«
import { useMutation, gql } from '@apollo/client';
import React, { useRef } from 'react';

const CREATE_POST = gql`
  mutation CreatePost($title: String!) {
    createPost(title: $title) { id, title }
  }
`;

function AddPost() {
  const titleInputRef = useRef(null);
  const [createPost, { loading }] = useMutation(CREATE_POST, {
    update(cache, { data: { createPost } }) {
      // readQueryã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«å­˜åœ¨ã—ãªã„å ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’æŠ•ã’ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€
      // try-catchã§å›²ã‚€ã‹ã€äº‹å‰ã«å­˜åœ¨ã‚’ç¢ºã‹ã‚ã‚‹ã®ãŒå …ç‰¢ã§ã™ã€‚
      const data = cache.readQuery({ query: GET_ALL_POSTS });
      if (data) {
        cache.writeQuery({
          query: GET_ALL_POSTS,
          data: { allPosts: [createPost, ...data.allPosts] },
        });
      }
    }
  });

  if (loading) return <p>Submitting...</p>;

  return (
    <form
      onSubmit={e => {
        e.preventDefault();
        if (titleInputRef.current.value.trim() === '') return;
        createPost({ variables: { title: titleInputRef.current.value } });
        titleInputRef.current.value = '';
      }}
    >
      <input ref={titleInputRef} placeholder="æ–°ã—ã„æŠ•ç¨¿ã®ã‚¿ã‚¤ãƒˆãƒ«" />
      <button type="submit">æŠ•ç¨¿ã‚’è¿½åŠ </button>
    </form>
  );
}
```

---

## ç¬¬4éƒ¨: ç™ºå±•çš„ãªãƒˆãƒ”ãƒƒã‚¯

æœ€å¾Œã«ã€å®Ÿä¸–ç•Œã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã§ä¸å¯æ¬ ã¨ãªã‚‹ã€ã‚ˆã‚Šé«˜åº¦ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’3ã¤ç´¹ä»‹ã—ã¾ã™ã€‚

### 4.1. ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ (Pagination)

å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«æ‰±ã†ãŸã‚ã®æ©Ÿèƒ½ã§ã™ã€‚`limit`/`offset`ã‚’ä½¿ã†ã‚·ãƒ³ãƒ—ãƒ«ãªæ–¹æ³•ã¨ã€ã‚ˆã‚Šå …ç‰¢ãª**ã‚«ãƒ¼ã‚½ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ»ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³**ãŒã‚ã‚Šã¾ã™ã€‚

- **ã‚«ãƒ¼ã‚½ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ»ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚­ãƒ¼ãƒä¾‹**:
  ```graphql
  type Query {
    posts(first: Int, after: String): PostConnection!
  }
  type PostConnection {
    edges: [PostEdge]
    pageInfo: PageInfo!
  }
  type PageInfo {
    hasNextPage: Boolean!
    endCursor: String
  }
  ```
Apollo Clientã«ã¯`fetchMore`é–¢æ•°ãªã©ã€ã“ã®æ–¹å¼ã‚’ä¾¿åˆ©ã«æ‰±ã†ãƒ˜ãƒ«ãƒ‘ãƒ¼ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

### 4.2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€é©åŒ–

Apollo Clientã¯å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’æ­£è¦åŒ–ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¾ã™ãŒã€`fetchPolicy`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æŒ™å‹•ã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚
- `cache-first` (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ): ã‚­ãƒ£ãƒƒã‚·ãƒ¥å„ªå…ˆ
- `network-only`: å¸¸ã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- `cache-and-network`: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’è¿”ã—ã¤ã¤ã€è£å´ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°

ã¾ãŸã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®`update`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ãˆã°ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä»‹ã•ãšã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç›´æ¥æ›¸ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã€éå¸¸ã«é«˜é€ŸãªUIæ›´æ–°ãŒå¯èƒ½ã§ã™ã€‚

### 4.3. èªè¨¼ãƒ»èªå¯

- **èªè¨¼ (Authentication)**: ã€Œã‚ãªãŸã¯èª°ã‹ï¼Ÿã€
  - ä¸€èˆ¬çš„ã«ã€ãƒ­ã‚°ã‚¤ãƒ³ç”¨ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§JWTç­‰ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã€ä»¥é™ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ·»ä»˜ã—ã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã¯httpOnlyã‚¯ãƒƒã‚­ãƒ¼ã¨ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚‚ä¸€èˆ¬çš„ã§ã™ã€‚
  - ã‚µãƒ¼ãƒãƒ¼ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹ãŸã³ã«ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆHTTPãƒ˜ãƒƒãƒ€ãƒ¼ã¾ãŸã¯ã‚¯ãƒƒã‚­ãƒ¼ã‹ã‚‰å–å¾—ï¼‰ã‚’æ¤œè¨¼ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’**ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è©°ã‚ã¦ãƒªã‚¾ãƒ«ãƒã«æ¸¡ã—ã¾ã™ã€‚
  > [!WARNING]
  > èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ `localStorage` ã«ä¿å­˜ã™ã‚‹æ–¹æ³•ã‚‚è¦‹ã‚‰ã‚Œã¾ã™ãŒã€XSSæ”»æ’ƒã«å¯¾ã—ã¦è„†å¼±ãªãŸã‚æ¨å¥¨ã•ã‚Œã¾ã›ã‚“ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’è€ƒæ…®ã™ã‚‹å ´åˆã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ `httpOnly` å±æ€§ã‚’ä»˜ã‘ãŸã‚¯ãƒƒã‚­ãƒ¼ã¨ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰±ã†æ–¹æ³•ãŒã‚ˆã‚Šå®‰å…¨ã§ã™ã€‚

- **èªå¯ (Authorization)**: ã€Œã‚ãªãŸã¯ä½•ãŒã§ãã‚‹ã‹ï¼Ÿã€
  - ãƒªã‚¾ãƒ«ãƒã¯ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å—ã‘å–ã‚Šã€ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦æ±‚ã•ã‚ŒãŸæ“ä½œã‚’å®Ÿè¡Œã™ã‚‹æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
  ```javascript
  editPost: (parent, args, context) => {
    if (!context.user) throw new Error('Not authenticated');
    // ... æ¨©é™ãƒã‚§ãƒƒã‚¯å‡¦ç† ...
  }
  ```

## ã¾ã¨ã‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€GraphQLã®åŸºæœ¬æ¦‚å¿µã‹ã‚‰ã€Node.jsã¨Reactã‚’ä½¿ã£ãŸå…·ä½“çš„ãªå®Ÿè£…ã€ãã—ã¦ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚„èªè¨¼ã¨ã„ã£ãŸå®Ÿè·µçš„ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¾ã§ã‚’é§†ã‘è¶³ã§è¦‹ã¦ãã¾ã—ãŸã€‚GraphQLã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã‚µãƒ¼ãƒãƒ¼é–“ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åŠ¹ç‡åŒ–ã—ã€ãƒ¢ãƒ€ãƒ³ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã‚’åŠ é€Ÿã•ã›ã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ã‚¬ã‚¤ãƒ‰ãŒã€ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«GraphQLã‚’å°å…¥ã™ã‚‹ä¸€åŠ©ã¨ãªã‚Œã°å¹¸ã„ã§ã™ã€‚
